// https://www.compilejava.net/

public class CVE20082370
{
    // arguments are passed using the text field below this editor
    public static void main(String[] args)
    {
        String normalized = "/page.jsp?blah=/../WEB-INF/web.xml";
        // Normalize the slashes and add leading slash if necessary
        if (normalized.indexOf('\\') >= 0)
            normalized = normalized.replace('\\', '/');
        // Resolve occurrences of "/../" in the normalized path
        while (true) {
            int index = normalized.indexOf("/../");
            if (index < 0)
                break;
            if (index == 0)
                break; // Trying to go outside our context
            int index2 = normalized.lastIndexOf('/', index - 1);
            normalized = normalized.substring(0, index2) +
                normalized.substring(index + 3);
        }
        // Return the normalized path that we have completed
        System.out.println(normalized);
    }
}

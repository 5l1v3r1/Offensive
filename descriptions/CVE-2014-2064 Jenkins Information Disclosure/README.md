## Vulnerable

### https://cxsecurity.com/cveshow/CVE-2014-2064

> The loadUserByUsername function in hudson/security/HudsonPrivateSecurityRealm.java in Jenkins before 1.551 and LTS before 1.532.2 allows remote attackers to determine whether a user exists via vectors related to failed login attempts.

### https://exchange.xforce.ibmcloud.com/vulnerabilities/91351

> Jenkins could allow a remote attacker to obtain sensitive information, caused by the returning of separate error messages when failing to logon within the BadCredentialsException in the HudsonPrivateSecurityRealm Class. An attacker could exploit this vulnerability to enumerate a user's account name and obtain sensitive information.

## Fixed

Fixed [with](https://github.com/jenkinsci/jenkins/commit/fbf96734470caba9364f04e0b77b0bae7293a1ec)

From:

```java
if (!u.isPasswordCorrect(password))
	throw new BadCredentialsException("Failed to login as "+username);
```

To:

```java
// Prevent (private security realm) usernames from being guessed.
if (!u.isPasswordCorrect(password)) {
    String message;
    try {
        message = ResourceBundle.getBundle("org.acegisecurity.messages").getString("AbstractUserDetailsAuthenticationProvider.badCredentials");
    } catch (MissingResourceException x) {
        message = "Bad credentials";
    }
    throw new BadCredentialsException(message);
}
```
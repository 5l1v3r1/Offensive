## Vulnerable

### http://legalhackers.com/advisories/Tomcat-DebPkgs-Root-Privilege-Escalation-Exploit-CVE-2016-1240.html with PoC

> Tomcat 8 <= 8.0.36-2 
> Tomcat 7 <= 7.0.70-2      
> Tomcat 6 <= 6.0.45+dfsg-1~deb8u1

> Tomcat (6, 7, 8) packages provided by default repositories on Debian-based  distributions (including Debian, Ubuntu etc.) provide a vulnerable tomcat init script that allows local attackers who have already gained access  to the tomcat account (for example, by exploiting an RCE vulnerability in a java web application hosted on Tomcat, uploading a webshell etc.) to escalate their privileges from tomcat user to root and fully compromise the  target system. Discovered by [dawid_golunski](https://twitter.com/dawid_golunski)

> Local attackers who have gained access to the server in the context of the tomcat user (for example, through a vulnerability in a web application) would  be able to replace the log file with a symlink to an arbitrary system file  and escalate their privileges to root once Tomcat init script (running as root) re-opens the catalina.out file after a service restart, reboot etc.
> As attackers would already have a tomcat account at the time of exploitation, they could also kill the tomcat processes to introduce the need for a restart.

> Local attackers who have gained access to tomcat user account (for example remotely via a vulnerable web application, or locally via weak webroot perms), could escalate their privileges to root and fully compromise the affected system.

## Fixed

As in [this](https://bugzilla.redhat.com/show_bug.cgi?id=1376712#c7) discussion a solution could be [this](https://bugzilla.redhat.com/attachment.cgi?id=1201570&action=diff).

Fixed [packages](https://security-tracker.debian.org/tracker/CVE-2016-1240)
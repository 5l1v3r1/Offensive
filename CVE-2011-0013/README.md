## Vulnerable

### http://www.securitytracker.com/id?1025026

> Version(s): 5.5.0 to 5.5.31, 6.0.0 to 6.0.29, 7.0.0 to 7.0.5
> Description:   A vulnerability was reported in Apache Tomcat Manager. A remote user can conduct cross-site scripting attacks.
> The HTML Manager interface does not properly filter HTML code from user-supplied input before displaying the input. A remote user can cause arbitrary scripting code to be executed by the target user's browser. The code will originate from the site running the Tomcat software and will run in the security context of that site. As a result, the code will be able to access the target user's cookies (including authentication cookies), if any, associated with the site, access data recently submitted by the target user via web form to the site, or take actions on the site acting as the target user.
> A demonstration exploit string is provided:
> <display-name>&lt;script&gt;alert('hi');&lt;/script&gt;</display-name>

### https://bugzilla.redhat.com/show_bug.cgi?id=675786

> Apache Tomcat 5.5.32 and 6.0.30 were released [1],[2] to fix, among other things, an XSS vulnerability in the HTML Manager [3].  The HTML Manager displayed unfiltered web application-provided data that could be used to trigger script execution by an administrative user when viewing the Manager pages, such as:
> <display-name>&lt;script&gt;alert('hi');&lt;/script&gt;</display-name> 
> For Tomcat 5.5.x, this was fixed in upstream revision 1057518 [4] and for Tomcat 6.x it was fixed in upstream revision 1057270 [5].

### https://cxsecurity.com/issue/WLB-2011020161

> <display-name><script>alert('hi');</script></display-name>


## Fixed

Fixed with a filter function `RequestUtil.filter(context.getDisplayName());` in HTMLManagerServlet.java (slightly different in 5.5.x)

Fixed with a filter function `writer.print(filter(name));` in StatusTransformer.java

